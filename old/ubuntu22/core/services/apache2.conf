<VirtualHost *:80>

ServerName example.com

DocumentRoot /var/www/example.com

<Directory /var/www/example.com>
AllowOverride None
Options -Indexes +FollowSymLinks
Options All
Options IncludesNOEXEC
Options -Includes
Options -ExecCGI
Options -Includes -ExecCGI
Options MultiViews
Require all granted

# Disable server-side scripting
<FilesMatch "\.(php|pl|py|jsp|asp|htm|shtml|sh|cgi)$">
Order Deny,Allow
Deny from all
</FilesMatch>

# Disable directory listing
Options -Indexes

# Enable Cross-Site Request Forgery protection
Header set X-XSS-Protection "1; mode=block"

# Prevent MIME based attacks
Header always set X-Content-Type-Options nosniff

# Set secure SSL/TLS protocols
SSLProtocol All -SSLv2 -SSLv3

# Set secure SSL/TLS ciphers
SSLCipherSuite ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+
#SSLCipherSuite ALL:!aNULL:!ADH:!eNULL:!LOW:!EXP:RC4+RSA:+HIGH:+MEDIUM

KeepAlive On
KeepAliveTimeout 15
LimitRequestBody  5242880

LimitRequestFields 50
LimitRequestFieldSize 4095
MaxClients 150
MaxKeepAliveRequests 50
TimeOut 600
FileETag None
TraceEnable off
